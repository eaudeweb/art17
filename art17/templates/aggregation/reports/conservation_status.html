{% extends 'aggregation/reports/report.html' %}

{% macro conclusion_cell(conclusion) %}
  <td class="dashboard-commentcount conclusion-{{ conclusion }}">
    {%- set conclusion_text = CONCLUSIONS.get(conclusion, conclusion) -%}
    <span title="{{ conclusion_text }}">{{ conclusion }}</span>
  </td>
{% endmacro %}

{% macro conclusion_span(conclusion, percent) %}
<span class="conclusion {{ conclusion }}">{{ conclusion }}</span>: 
<span class="pull-right">{{ percent or 0 }}%</span>
<br/>
{% endmacro %}

{% macro conclusion_stats(stats) %}
  <th nowrap="nowrap">
    {{ conclusion_span('FV', stats.get('FV')) }}    
    {{ conclusion_span('U1', stats.get('U1')) }}    
    {{ conclusion_span('U2', stats.get('U2')) }}    
    {{ conclusion_span('XX', stats.get('XX')) }}   
  </th>
{% endmacro %}

{% block pagecontent %}

  <h3>Specii</h3>
  <table class="table table-bordered table-condensed">
    <thead>
    <tr>
      <th>Nume</th>
      <th>Grup</th>
      <th>Cod N2000</th>
      <th>Bioregiune</th>
      <th>Evaluare Areal</th>
      <th>Evaluare Populație</th>
      <th>Evaluare Habitate</th>
      <th>Evaluare Perspective</th>
      <th>Evaluare Globală</th>
    </tr>
    </thead>
    <tbody>
    {% for spec in species %}
      <tr>
        <td>{{ spec.species.name }}</td>
        <td>{{ spec.species.lu.group_code }}</td>
        <td>{{ spec.species.code }}</td>
        <td>{{ spec.region }}</td>
        {{ conclusion_cell(spec.conclusion_range) }}
        {{ conclusion_cell(spec.conclusion_population) }}
        {{ conclusion_cell(spec.conclusion_habitat) }}
        {{ conclusion_cell(spec.conclusion_future) }}
        {{ conclusion_cell(spec.conclusion_assessment) }}
      </tr>
    {% endfor %}</tbody>
    <tfoot>
    <tr>
      <th colspan="4">Total:</th>
      {{ conclusion_stats(stats['species']['range']) }}
      {{ conclusion_stats(stats['species']['population']) }}
      {{ conclusion_stats(stats['species']['habitat']) }}
      {{ conclusion_stats(stats['species']['future']) }}
      {{ conclusion_stats(stats['species']['assessment']) }}
    </tr>
    </tfoot>
  </table>

  <h3>Habitate</h3>
  <table class="table table-bordered table-condensed">
    <tr>
      <th>Nume</th>
      <th>Cod N2000</th>
      <th>Bioregiune</th>
      <th>Evaluare Areal</th>
      <th>Evaluare Suprafața</th>
      <th>Evaluare Struct. func</th>
      <th>Evaluare Perspectiva</th>
      <th>Evaluare Globală</th>
    </tr>
    {% for hab in habitats %}
      <tr>
        <td>{{ hab.habitat.lu.display_name }}</td>
        <td>{{ hab.habitat.code }}</td>
        <td>{{ hab.region }}</td>
        {{ conclusion_cell(hab.conclusion_range) }}
        {{ conclusion_cell(hab.conclusion_area) }}
        {{ conclusion_cell(hab.conclusion_structure) }}
        {{ conclusion_cell(hab.conclusion_future) }}
        {{ conclusion_cell(hab.conclusion_assessment) }}
      </tr>
    {% endfor %}
    <tfoot>
    <tr>
      <th colspan="3">Total:</th>
      {{ conclusion_stats(stats['habitats']['range']) }}
      {{ conclusion_stats(stats['habitats']['area']) }}
      {{ conclusion_stats(stats['habitats']['structure']) }}
      {{ conclusion_stats(stats['habitats']['future']) }}
      {{ conclusion_stats(stats['habitats']['assessment']) }}
    </tr>
    </tfoot>
  </table>

{% endblock %}

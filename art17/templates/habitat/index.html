{% extends "layout.html" %}


{% block title %}
{%- if habitat %}{{ habitat.name }} &mdash; {% endif %}
{{- super() }}
{%- endblock title %}


{% block content %}
  <form class="habitatfilter">
    <fieldset>
      <legend>Filtrare habitate</legend>

      <div class="form-group">
        <label for="habitatfilter-group">Habitat</label>
        <input name="habitat" value="{{ current_habitat_code }}"
               type="hidden" id="habitatfilter-group">
      </div>

      <div class="form-group">
        <button type="submit">filtreazÄƒ</button>
      </div>

      <div class="form-group">
        <label for="habitatfilter-region">Regiune</label>
        <input name="region" value="{{ current_region_code }}"
               type="hidden" id="habitatfilter-region">
      </div>
    </fieldset>
  </form>

 {% if habitat %}
  <p>
    <strong>{{ habitat.name }}</strong>,
    cod: {{ habitat.code }}
  </p>

  {%- include 'habitat/records.html' with context %}
 {% endif %}
{% endblock content %}


{% block script %}
  {%- from 'bits.html' import script %}
  {{ super() }}
  {{ script('detail.js') }}
  {{ script('comments.js') }}

  <script>
    (function() {
      "use strict";

      var habitatfilter = $('.habitatfilter');
      var habitat_list = {{ habitat_list|tojson|safe }};
      var region_list = {{ region_list|tojson|safe }};

      habitatfilter.find('[name=habitat]').select2({
        data: habitat_list,
        width: '40em'
      });


      var region_select = habitatfilter.find('[name=region]').select2({
        data: [{id: null, text: "toate"}].concat(region_list),
        width: '15em'
      });
    })();
  </script>
{% endblock script %}

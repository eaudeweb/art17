{% extends "layout.html" %}


{% block title %}
{%- if species %}{{ species.name }} &mdash; {% endif %}
{{- super() }}
{%- endblock title %}


{% block breadcrumbs %}
  {%- from 'bits.html' import breadcrumbs %}
  {{ breadcrumbs([
          ('home', url_for('views.home')),
          ('specii', None),
      ]) }}
{% endblock breadcrumbs %}


{% block content %}

  <form class="speciesfilter">
    <fieldset>
      <legend>Filtrare specii</legend>

      <div class="form-group">
        <label for="speciesfilter-group">Grup</label>
        <input name="group" value="{{ current_group_code }}"
               type="hidden" id="speciesfilter-group">
      </div>

      <div class="form-group">
        <label for="speciesfilter-species">Specie</label>
        <input name="species" value="{{ current_species_code or '' }}"
               type="hidden" id="speciesfilter-species">
      </div>

      <div class="form-group">
        <label for="speciesfilter-region">Regiune</label>
        <input name="region" value="{{ current_region_code }}"
               type="hidden" id="speciesfilter-region">
      </div>

      <div class="form-group">
        <button type="submit">filtreazÄƒ</button>
      </div>
    </fieldset>
  </form>

 {% if species %}
  <p>
    {%- set annex_list =
      (["II"] if species.annex_II else []) +
      (["IV"] if species.annex_IV else []) +
      (["V"] if species.annex_V else []) %}

    <strong>{{ species.name }}</strong>,
    cod: {{ species.code }},
    anexe: {{ ", ".join(annex_list) if annex_list else "--" }}
  </p>

  {%- include 'species/records.html' with context %}
 {% endif %}
{% endblock content %}


{% block script %}
  {%- from 'bits.html' import script %}
  {{ super() }}
  {{ script('recordfilter.js') }}
  {{ script('detail.js') }}
  {{ script('commentstatus.js') }}
  {{ script('messages.js') }}

  <script>
    App.species_groups = {{ species_groups|tojson|safe }};
    App.species_list = {{ species_list|tojson|safe }};
  </script>
  {{ script('speciesfilter.js') }}
{% endblock script %}

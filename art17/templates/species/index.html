{% extends "layout.html" %}


{% block content %}
<form class="speciesfilter">
  <fieldset>
    <legend>Filtrare specii</legend>

    <label>
      Grup
      <select name="group">
        <option value="">--</option>
        {% for group in species_groups %}
          {% set selected = (group == current_group) %}
          <option value="{{ group.code }}"
                  {%- if selected %} selected{% endif %}>
            {{- group.description -}}
          </option>
        {% endfor %}
      </select>
    </label>

    <label>
      Specie
      <select name="species">
        <option value="">--</option>
        {% for species in species_list %}
          {% set selected = (species == current_species) %}
          <option value="{{ species.speciescode }}"
                  {%- if selected %} selected{% endif %}>
            {{- species.speciesname -}}
          </option>
        {% endfor %}
      </select>
    </label>
  </fieldset>
</form>

<ul>
{% for row in records %}
  {% set speciescode = row.speciescode %}
  {% set url = url_for('.species_view', speciescode=speciescode) %}
  <li><a href="{{ url }}">{{ speciescode }}</a></li>
{% endfor %}
</ul>
{% endblock content %}


{% block styles %}
  {% from 'bits.html' import link %}
  {{ link('lib/select2-3.4.2/select2.css') }}
{% endblock styles %}


{% block script %}
  {% from 'bits.html' import script %}
  {{ script('lib/jquery-1.10.2/jquery.min.js') }}
  {{ script('lib/select2-3.4.2/select2.min.js') }}
  {{ script('lib/select2-3.4.2/select2_locale_ro.js') }}

  <script>
    (function() {
      var speciesfilter = $('.speciesfilter');

      speciesfilter.find('select').change(function() {
        speciesfilter.submit();
      });

      speciesfilter.find('select[name=species]').select2({width: '25em'});
    })();
  </script>
{% endblock script %}

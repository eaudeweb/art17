{% extends "layout.html" %}


{% block content %}
  <form class="speciesfilter">
    <fieldset>
      <legend>Filtrare specii</legend>

      <div class="form-group">
        <label for="speciesfilter-group">Grup</label>

        <select name="group" id="speciesfilter-group">
          <option value="">--</option>

          {% for group in species_groups %}
            {% set selected = (group == current_group) %}
            <option value="{{ group.code }}"
                    {%- if selected %} selected{% endif %}>
              {{- group.description -}}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <label for="speciesfilter-species">Specie</label>

        <select name="species" id="speciesfilter-species">
          <option value="">--</option>

          {% for species in species_list %}
            {% set selected = (species == current_species) %}
            <option value="{{ species.speciescode }}"
                    {%- if selected %} selected{% endif %}>
              {{- species.speciesname -}}
            </option>
          {% endfor %}
        </select>
      </div>

      <div class="form-group">
        <button type="submit">filtreazÄƒ</button>
      </div>
    </fieldset>
  </form>

 {% if species %}
  <p>
    {%- set annex_list =
      (["II"] if species.annex_II else []) +
      (["IV"] if species.annex_IV else []) +
      (["V"] if species.annex_V else []) %}

    <strong>{{ species.name }}</strong>,
    cod: {{ species.code }},
    anexe: {{ ", ".join(annex_list) if annex_list else "--" }}
  </p>
 {% endif %}

  {%- include 'species/records.html' with context %}

{% endblock content %}


{% block styles %}
  {{ super() }}
  {% from 'bits.html' import link %}
  {{ link('lib/select2-3.4.2/select2.css') }}
{% endblock styles %}


{% block script %}
  {{ super() }}
  {% from 'bits.html' import script %}
  {{ script('lib/select2-3.4.2/select2.min.js') }}
  {{ script('lib/select2-3.4.2/select2_locale_ro.js') }}

  <script>
    (function() {
      var speciesfilter = $('.speciesfilter');

      speciesfilter.find('select[name=species]').select2({width: '25em'});
    })();
  </script>
{% endblock script %}

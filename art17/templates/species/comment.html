{% extends "layout.html" %}
{% from 'common/comment_bits.html' import error_cls, errors %}


{% block title %}
  {%- if species %}{{ species.name }} &mdash; {% endif %}
  {{- super() }}
{%- endblock title %}


{% block breadcrumbs %}
  {%- from 'bits.html' import breadcrumbs %}
  {{ breadcrumbs([
          ('home', url_for('views.home')),
          ('specii', next_url or url_for('.index')),
          ('comentariu', None),
      ]) }}
{% endblock breadcrumbs %}


{% block content %}
{%- from 'common/td.html' import
    range_html, trend_detail_html, reference_value_html, period_html,
    population_size_html
    with context %}

  <h1>
    Comentariu pentru
    {{ species.lu.speciesname }}
    ({{ record.region }})
  </h1>

  <form method="post">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Areal</h3>
      </div>

      <div class="panel-body">
        <div class="form-group">
          <label for="range.surface_area">
            Suprafață (km²)
          </label>

          {{ errors(form.range.surface_area) }}

          <div class="row">
            <div class="col-sm-4 {{- error_cls(form.range.surface_area) }}">
              {{ form.range.surface_area(class='form-control') }}
            </div>

            <div class="col-sm-2"></div>

            <div class="col-sm-6 text-primary">
              {{ range_html(record.range) }}
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="range.method">
            Metoda utilizată - suprafața arealului
          </label>

          {{ errors(form.range.method) }}

          <div class="row">
            <div class="col-sm-6 {{- error_cls(form.range.method) }}">
              {{ form.range.method(class='form-control') }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ record.range.method }}
            </div>
          </div>
        </div>

        <div class="form-group">
          {%- set trend_short = form.range.trend_short %}
          <label for="range.trend_short.trend">
            Tendință pe termen scurt
          </label>

          {{ errors(trend_short) }}

          <div class="row">
            <div class="col-sm-2 {{- error_cls(trend_short.trend) }}">
              {{ trend_short.trend(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(trend_short.period.start) }}">
              {{ trend_short.period.start(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(trend_short.period.end) }}">
              {{ trend_short.period.end(class='form-control') }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ trend_detail_html(record.range.trend_short) }}
              {{ period_html(record.range.trend_short.period) }}
            </div>
          </div>
        </div>

        <div class="form-group">
          {%- set trend_long = form.range.trend_long %}
          <label for="range.trend_long.trend">
            Tendință pe termen lung
          </label>

          {{ errors(trend_long) }}

          <div class="row">
            <div class="col-sm-2 {{- error_cls(trend_long.trend) }}">
              {{ trend_long.trend(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(trend_long.period.start) }}">
              {{ trend_long.period.start(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(trend_long.period.end) }}">
              {{ trend_long.period.end(class='form-control') }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ trend_detail_html(record.range.trend_long) }}
              {{ period_html(record.range.trend_long.period) }}
            </div>
          </div>
        </div>

        <div class="form-group">
          {%- set reference_value = form.range.reference_value %}
          <label for="range.reference_value.op">
            Arealul favorabil de referință
          </label>

          {{ errors(reference_value) }}

          <div class="row">
            <div class="col-sm-2 {{- error_cls(reference_value.op) }}">
              {{ reference_value.op(class='form-control') }}
            </div>

            <div class="col-sm-4 {{- error_cls(reference_value.number) }}">
              {{ reference_value.number(class='form-control') }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ reference_value_html(record.range.reference_value,
                        unit='km²') }}
            </div>
          </div>
        </div>

        <div class="form-group">
          <label for="range.reference_value.method">
            Arealul favorabil de referință - metoda
          </label>

          {{ errors(form.range.reference_value.method) }}

          <div class="row">
            <div class="col-sm-6 {{- error_cls(form.range.reference_value.method) }}">
              {{ form.range.reference_value.method(class='form-control', rows=2) }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ record.range.reference_value.method }}
            </div>
          </div>
        </div>

        <div class="form-group">
          {%- set conclusion = form.range.conclusion %}
          <label for="range.conclusion.value">
            Concluzie
          </label>

          {{ errors(conclusion) }}

          <div class="row">
            <div class="col-sm-3 {{- error_cls(conclusion.value) }}">
              {{ conclusion.value(class='form-control') }}
            </div>

            <div class="col-sm-3 {{- error_cls(conclusion.trend) }}">
              {{ conclusion.trend(class='form-control') }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ record.range.conclusion.value }}
            </div>
          </div>
        </div>
      </div>

      <div class="panel-heading">
        <h3 class="panel-title">Populație</h3>
      </div>

      <div class="panel-body">
        <div class="form-group">
          {%- set population = form.population.size.population %}
          <label for="population.size.population.unit">
            Estimarea mărimii populației
          </label>

          {{ errors(population) }}

          <div class="row">
            <div class="col-sm-2 {{- error_cls(population.unit) }}">
              {{ population.unit(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(population.min) }}">
              {{ population.min(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(population.max) }}">
              {{ population.max(class='form-control') }}
            </div>

            <div class="col-sm-6 text-primary">
              {{ population_size_html(record.population.size) }}
            </div>
          </div>
        </div>

        <div class="form-group">
          {%- set population_alt = form.population.size.population_alt %}

          {{ errors(population_alt) }}

          <div class="row">
            <div class="col-sm-2 {{- error_cls(population_alt.unit) }}">
              {{ population_alt.unit(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(population_alt.min) }}">
              {{ population_alt.min(class='form-control') }}
            </div>

            <div class="col-sm-2 {{- error_cls(population_alt.max) }}">
              {{ population_alt.max(class='form-control') }}
            </div>

          </div>
        </div>

      </div>

    </div>

    {%- if next_url %}
      <input type="hidden" name="next" value="{{ next_url }}">
    {%- endif %}

    <button type="submit" class="recordcomment-save">Save</button>
  </form>
{% endblock content %}
